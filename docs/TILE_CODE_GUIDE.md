# 1:100万图幅编号指南

## 图幅编号系统

1:100万图幅编号是全球通用的标准编号系统，用于标识1:100万比例尺的地图图幅。

### 编号规则

图幅编号由**字母+数字**组成，例如：
- **F49** - 表示第F行第49列
- **F50** - 表示第F行第50列
- **G49** - 表示第G行第49列
- **G50** - 表示第G行第50列

### 图幅范围

每个1:100万图幅覆盖约**6°经度 × 4°纬度**的地理范围。

### 中国主要图幅

中国主要位于以下图幅范围内：

| 图幅编号 | 大致范围（经度） | 大致范围（纬度） | 主要覆盖区域 |
|---------|----------------|----------------|------------|
| F49 | 108° - 114° | 20° - 24° | 广东、广西、海南、湖南南部 |
| F50 | 114° - 120° | 20° - 24° | 广东、福建、江西、浙江 |
| G49 | 108° - 114° | 24° - 28° | 湖南、贵州、广西、广东北部 |
| G50 | 114° - 120° | 24° - 28° | 江西、浙江、安徽、福建、湖南 |
| G51 | 120° - 126° | 24° - 28° | 浙江、江苏、上海 |
| H49 | 108° - 114° | 28° - 32° | 湖北、湖南、重庆、四川 |
| H50 | 114° - 120° | 28° - 32° | 湖北、安徽、江苏、河南 |
| I49 | 108° - 114° | 32° - 36° | 四川、陕西、甘肃 |
| I50 | 114° - 120° | 32° - 36° | 河南、山东、河北、山西 |

## 如何根据地理位置确定图幅

### 方法1：根据经纬度计算

1. **确定经度范围**：
   - 经度每6°为一个图幅
   - 图幅列号 = floor((经度 + 180) / 6) + 1
   - 例如：113°经度 → (113 + 180) / 6 = 48.83 → 列号49

2. **确定纬度范围**：
   - 纬度每4°为一个图幅
   - 图幅行号字母：从南到北依次为A, B, C, ..., Z
   - 中国主要区域的行号：F, G, H, I等

### 方法2：使用已知城市位置

| 城市 | 经度范围 | 纬度范围 | 主要图幅 |
|------|---------|---------|---------|
| 北京 | 116° - 117° | 39° - 40° | J50 |
| 上海 | 121° - 122° | 31° - 32° | H51 |
| 广州 | 113° - 114° | 23° - 24° | F49 |
| 深圳 | 114° - 115° | 22° - 23° | F49, F50 |
| 惠州 | 114° - 115° | 22.7° - 23.8° | F49, F50 |
| 杭州 | 120° - 121° | 30° - 31° | H50, H51 |
| 成都 | 104° - 105° | 30° - 31° | H48 |
| 武汉 | 114° - 115° | 30° - 31° | H50 |

### 方法3：使用MCP工具查询

1. **使用 `list_tile_codes` 工具**：
   - 查看数据库中已导入的所有图幅代码
   - 了解哪些图幅有数据可用

2. **使用 `query_data` 工具**：
   - 使用 `attribute_filter: {"tile_code": "F49"}` 过滤特定图幅
   - 或使用 `attribute_filter: {"tile_code": ["F49", "F50"]}` 查询多个图幅

3. **使用 `execute_sql` 工具**：
   - 在SQL中使用 `WHERE tile_code IN ('F49', 'F50')` 过滤
   - 或使用 `WHERE tile_code = 'F49'` 查询单个图幅

## 查询示例

### 示例1：查询惠州市数据

惠州市位于：
- 经度：114.0° - 115.0°
- 纬度：22.7° - 23.8°

主要图幅：**F49** 和 **F50**

```sql
-- 查询F49和F50图幅的数据
SELECT * FROM administrative_boundary_area
WHERE tile_code IN ('F49', 'F50')
  AND geom && ST_MakeEnvelope(114.0, 22.7, 115.0, 23.8, 4326)
```

### 示例2：查询广州市数据

广州市位于：
- 经度：113.0° - 113.5°
- 纬度：22.7° - 23.4°

主要图幅：**F49**

```sql
-- 查询F49图幅的数据
SELECT * FROM administrative_boundary_area
WHERE tile_code = 'F49'
  AND geom && ST_MakeEnvelope(113.0, 22.7, 113.5, 23.4, 4326)
```

### 示例3：查询跨图幅区域

如果查询区域跨越多个图幅，必须查询所有相关图幅：

```sql
-- 查询跨越F49和F50的区域
SELECT * FROM road
WHERE tile_code IN ('F49', 'F50')
  AND geom && ST_MakeEnvelope(113.5, 22.5, 115.5, 24.0, 4326)
```

## 重要提示

1. **必须先查看图幅**：使用 `list_tile_codes` 查看有哪些图幅可用
2. **不要只查F49**：根据目的地地理位置确定需要查询的图幅
3. **跨图幅查询**：如果区域跨越多个图幅，必须查询所有相关图幅
4. **图幅过滤**：在查询时使用 `tile_code` 字段过滤，提高查询效率
5. **空间范围结合**：结合空间范围（bbox）和图幅过滤，确保查询完整

## 常见错误

❌ **错误**：只查询F49图幅，忽略其他图幅
✅ **正确**：先使用 `list_tile_codes` 查看可用图幅，根据目的地确定需要查询的图幅

❌ **错误**：不指定图幅，查询所有数据（可能很慢）
✅ **正确**：使用 `tile_code` 过滤，只查询相关图幅的数据

❌ **错误**：只使用空间范围，不使用图幅过滤
✅ **正确**：结合空间范围和图幅过滤，提高查询效率和准确性

